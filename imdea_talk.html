<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Finding the Odd Function</title>
    <meta charset="utf-8" />
    <meta name="author" content="Oluwasegun Ojo" />
    <meta name="date" content="2021-12-16" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Finding the Odd Function
## Outlier Detection for Functional Data
### Oluwasegun Ojo
### IMDEA Networks Institute, Leganes, Spain <br/>UC3M, Madrid, Spain
### 2021-12-16

---



class: inverse, center, middle

# Functional Data Analysis (FDA)

---


# What is Functional Data Analysis?  

- FDA deals with analysing data *that can be considered as* **curves** or **functions**. 

- In FDA, a single observation is a curve or function over some domain. 

- In univariate data analysis, each data point is a single number, `\(x\in \mathbb{R}\)`.

- In multivariate data analysis, each data point is a vector of `\(p\)` dimension: 
$$\textbf{X} \in \mathbb{R}^p; \ \ \ \ \  p \in \mathbb{Z}. $$
- In FDA, each data point is assumed to be: 
  - Infinite dimensional function. 
  - Continuous on its domain
  - Can be evaluated at any point on the domain. 

- In reality the domain can be: the real line `\(\mathbb{R}\)`, `\(\mathbb{R}^p\)` or more complex sets or intervals.


- We focus our attention on functions defined on  `\(\mathbb{R}\)`. 

---

# Functional data example

- Daily average temperature between 1980-2009 from 73 weather stations&lt;sup&gt;*&lt;/sup&gt;

&lt;img src="gfx/aemet_spanish_raw_functional.png" width="100%" style="display: block; margin: auto;" /&gt;

.footnote[[*] Data obtained from [fda.usc](https://onlinelibrary.wiley.com/doi/abs/10.1002/env.878) R package.] 

---

# Dealing with functions

- Functions are assumed to be square integrable, defined on the unit interval `\([0,1]\)`: 
`$$\int f^2(t)dt = \int_0^1 f(t)^2 &lt; \infty.$$`
- Denote by `\(L^2[0,1]\)`, the set of all square integrable functions. Then `\(L^2[0,1]\)` is a vector space and we can define the inner product of two functions: 
`$$\langle f, g\rangle = \int_0^1 f(t)g(t)dt$$`
- Define the norm of a function as the square root of its inner product with itself: 
`$$\lVert f \rVert =  \langle f, f\rangle \ = \left( \int_0^1 f(t)^2dt \right)^{1/2}$$`

- Now we can measure the distance between two functions `\(f\)` and `\(g\)`: 
`$$d(f, g) = \lVert f - g\rVert$$`


---

# Objectives of FDA

- Rather than random variable, we now deal with **random functions**.
- Each observed function is now a realization of a random function. 
- Just like in univariate and multivariate data analysis: 
  - We can do exploratory analysis and visualization
  - Modelling and hypothesis testing
  - Classification and Clustering

- **Exploratory Analysis** deals with data representation, smoothing, [outlier detection](https://link.springer.com), visualization, dimension reduction using PCA. 

- **Modelling**: deals with regression in functional settings: 
  - scalar on function regression
  - function on function regression etc.
  

- **Classification and Clustering**: deals with classifying and clustering functional observations. 

---
class: inverse, center, middle

# Outlier Detection

---

# What is an outlier in functional setting?

- An outlier is an observation generated by a functional random variable with a different distribution from the one generating the normal observations of a functional sample. &lt;sup&gt;*&lt;/sup&gt;
- Since we dealing with functions over a domain: 
  - An outlier can be outlying all through the domain: **persistent outliers**
  - An outlier can be outlying for a small part of the domain. **non-persistent outliers**

- Also a persistent outlier can show different outlying behaviours:
  - **shift/magnitude outlier:** curves with the same shape with *normal observations* but displaced vertically or horizontally away from the mass of the data. 
  
  - **Amplitude outliers:** curves that have similar trend/shape as the majority but with different scale/amplitude (applies mostly to periodic curves). 
  
  - **shape outliers:** curves whose shape differs from the majority

- It is desirable to identify type of a functional outlier.  

.footnote[[*] [Febrero et al. (2008)](https://onlinelibrary.wiley.com/doi/abs/10.1002/env.878)]

---

# Functional outliers examples

&lt;img src="gfx/models_illustration.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# Our contribution

- A scalable outlier detection for functional data. 
- Classifies the different types of functional outliers (shape, magnitude, amplitude)
- Classification of outliers is unsupervised. No need for visualization or intervention. 

--


- [Detecting and classifying outliers in big functional data](https://link.springer.com/article/10.1007/s11634-021-00460-9). *Advances in Data Analysis and Classification* (2021)
- Work in collaboration: 
  - Antonio Fern√°ndez Anta
  - Rosa Elvira Lillo Rodriguez (UC3M)
  - Carlo Sguera (Formerly UC3M, now SavanaMed)

---

# Two functions: magnitude difference

&lt;img src="gfx/two_fun_mag.png" width="90%" style="display: block; margin: auto;" /&gt;

---

# Two functions: amplitude difference

&lt;img src="gfx/two_fun_amp.png" width="90%" style="display: block; margin: auto;" /&gt;

---

# Two functions: shape difference

&lt;img src="gfx/two_fun_sha.png" width="90%" style="display: block; margin: auto;" /&gt;

---

# Proposal

- We propose two methods that compute three outlyingness indices for each functional observation

- The three outlyingness indices are: 
  - **Amplitude index** denoted by `\(I_A\)`,
  - **Magnitude index** (denoted by `\(I_M\)`)
  - **Shape index** (denoted by `\(I_S\)`)
  
- We call the two methods:
  - **Fast-MUOD**
  - **Semifast-MUOD**. 

---

# Fast-MUOD

- Let `\(Y = \{Y_1(t), Y_2(t), \ldots, Y_n(t)\}\)` be the set of functional observations of interest.  

- Denote by `\(\tilde{Y}(t)\)`, pointwise median of `\(Y\)` (or any other type of median of `\(Y\)`).

- We define the Fast-MUOD shape index of function `\(Y_i\)` w.r.t. to `\(\tilde{Y}\)` as:
`$$I_S(Y_i, \tilde{Y}) := |r(Y_i(t), \tilde{Y}(t)) - 1|,$$` where `\(r(Y_i(t), \tilde{Y}(t))\)` is the estimated *Pearson correlation correlation coefficient* between the points of `\(Y_i(t)\)` and `\(\tilde{Y}(t)\)`. 


- We define the Fast-MUOD amplitude index of function `\(Y_i\)` w.r.t. to `\(\tilde{Y}\)` as:
`$$I_A(Y_i, \tilde{Y}) = |\beta_i - 1|,$$` where `\(\beta_i\)` is the estimated *slope* of a simple linear regression line between the points of `\(Y_i(t)\)` and `\(\tilde{Y}(t)\)` given by: `$$\beta_i = \frac{\text{cov}(Y_i, \tilde{Y})}{\text{var}(\tilde{Y})}; \ \ \ \ \text{var}(\tilde Y)\ne 0$$`



---
# Fast-MUOD

- We define the Fast-MUOD magnitude index of function `\(Y_i\)` w.r.t. to `\(\tilde{Y}\)` as:
`$$I_M(Y_i, \tilde{Y}) = |\alpha_i|,$$` where `\(\alpha_i\)` is the estimated *intercept* of a simple linear regression line between the points of `\(Y_i(t)\)` and `\(\tilde{Y}(t)\)`.


--

- **Illustration (Magnitude Index)**

&lt;img src="gfx/fat_magnitude_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;
Pointwise median in color red
---

# Fast-MUOD

**Illustration (Amplitude Index)**

&lt;img src="gfx/fat_amplitude_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;
Pointwise median in color red
---
# Fast-MUOD

**Illustration (Shape Index)**

&lt;img src="gfx/fat_shape_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;
Pointwise median in color red

---

# Semifast-MUOD

- Compute the three indices w.r.t. a reference sample drawn from `\(Y\)`.

- The sampling proportion `\(p \in [0,1]\)` is fixed.  

- Denote by `\(X = \{X_i(t)\}_{i = 1}^{n_X}\)`, the random sample selected from `\(Y\)` without replacement, where `\(n_X\)` is the sample size. 

- We define the Semifast-MUOD shape index of function `\(Y_i\)` w.r.t. to `\(F_X\)`, the empirical distribution of `\(X\)` as:
`$$I_S(Y_i, F_X) := \left| \frac{1}{n_X} \sum_{j = 1}^{n_X} r(Y_i(t), X_j(t)) - 1 \right|,$$` where `\(r(Y_i(t), X_j(t))\)` is the estimated *Pearson correlation correlation coefficient* between the points of `\(Y_i(t)\)` and `\(X_j(t)\)`. 


---
# Semifast-MUOD
- We define the Semifast-MUOD amplitude index of function `\(Y_i\)` w.r.t. to `\(F_X\)` as:
`$$I_A(Y_i, F_X) := \left|\frac{1}{n_X} \sum_{j = 1}^{n_X} \beta_j - 1 \right|,$$` where `\(\beta_j\)` is the estimated *slope* of a simple linear regression line between the points of `\(Y_i(t)\)` and `\({X}_j(t)\)` given by: `$$\beta_j = \frac{\text{cov}(Y_i, X_j )}{\text{var}(X_j)}; \ \ \ \ \text{var}(X_j)\ne 0$$`


- We define the Semifast-MUOD magnitude index of function `\(Y_i\)` w.r.t. to `\(F_X\)` as:
`$$I_M(Y_i, F_X) = \left| \frac{1}{n_X} \sum_{j = 1}^{n_X} \alpha_j\right|,$$` where `\(\alpha_j\)` is the estimated *intercept* of a simple linear regression line between the points of `\(Y_i(t)\)` and `\(X_j(t)\)`.


---
# Semifast-MUOD illustration

**Illustration (Magnitude Index):**

&lt;img src="gfx/sfat_magnitude_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;

Reference sample `\(\{X_i(t)\}_{i = 1}^{n_X}\)` in color green
---

# Semifast-MUOD illustration

- **Illustration (Amplitude Index):**

&lt;img src="gfx/sfat_amplitude_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;

Reference sample `\(\{X_i(t)\}_{i = 1}^{n_X}\)` in color green

---
# Semifast-MUOD illustration

- **Illustration (Shape Index):**

&lt;img src="gfx/sfat_shape_illustration.png" width="100%" style="display: block; margin: auto;" /&gt;

Reference sample `\(\{X_i(t)\}_{i = 1}^{n_X}\)` in color green
---

# Next steps...

- For each functional observation `\(Y_i(t) \in Y\)`,  compute the three indices `\(I_A(Y_i), I_S(Y_i)\)` and `\(I_M(Y_i)\)`. 

- Apply a classical boxplot (individually) to the three univariate data sets: `\(\{I_A(Y_i)\}_{i = 1}^n\)`, `\(\{I_M(Y_i)\}_{i = 1}^n\)`, and `\(\{I_S(Y_i)\}_{i = 1}^n\)` to separate the indices of the outliers from non-outliers. 

- Obtain the three set of outliers: 
  - Amplitude outliers from the boxplot applied on `\(\{I_A(Y_i)\}_1^n\)`.
  - Magnitude outliers from the boxplot applied on `\(\{I_M(Y_i)\}_1^n\)`.
  - Shape outliers from the boxplot applied on `\(\{I_S(Y_i)\}_1^n\)`.
  
- Classification of the outliers are **not mutually exclusive**, i.e.,
  -an observation `\(Y_i\)` can simultaneously be a shape, amplitude and magnitude outlier.

- The classification into various outlier type is done automatically **without the need for intervention or visualization** (useful for big functional data that are difficult to visualize). 
 
---
# Boxplot cutoff illustration

- Distribution of typical magnitude and amplitude indices with individual boxplots

- **Only right whisker** considered as cutoff

&lt;img src="gfx/index_dist_slide_fast.png" width="100%" style="display: block; margin: auto;" /&gt;


---

class: inverse, center, middle

# Simulation and Benchmark Tests

---
# Competing methods from literature

- **OGMBD**:
  - Outliergram method proposed by [Arribas-Gil &amp; Romo (2014)](https://doi.org/10.1093/biostatistics/kxu006)
  - Originally for detecting shape outliers
  - another method (**functional boxplot**) used for detecting magnitude outliers.
- **MS-Plot**:
  - Magnitude shape plot proposed by [Dai &amp; Genton (2018)](https://doi.org/10.1080/10618600.2018.1473781)
  - Very good in detecting shape outliers
  - Sometimes it fails to detect magnitude outliers
  - Amplitude outliers are sometimes not detected
  - Also works for multivariate functional data: `\(X(t) \in \mathbb{R}^p\)`.
  - Visualization needed to identify type of outlier
  
- **TVDMSS**:
  - Total Variation Depth and Modified Shape Similarity by [Huang &amp; Sun (2019)](https://doi.org/10.1080/00401706.2019.1574241),
  - Good in detecting shape outliers
  - Computationally intensive
---

# Simulation Models 1 - 2

- Plot of simulation models 1 and 2 &lt;sup&gt;*&lt;/sup&gt;: 

- Outliers in orange
&lt;img src="gfx/model1-2.png" width="100%" style="display: block; margin: auto;" /&gt;

.footnote[[*] Image credit: [Ojo et al. (2021)](https://link.springer.com/article/10.1007/s11634-021-00460-9)]

---
# Results Models 1 - 2

- Data were generated from Model 1 and Model 2

- Each data contains 300 curves with 10% outliers. Curves evaluated on 60 domain points

- 500 repetitions. % TPR and FPR are shown with standard deviations


|Method        | TPR-Model1 | FPR-Model1 (SD) | TPR-Model2 (SD) | FPR-Model2 (SD) |
|:-------------|:----------:|:---------------:|:---------------:|:---------------:|
|Fast-MUOD     |     -      |   9.90(1.50)    |  100.00(0.00)   |   8.95(1.59)    |
|Fast-MUOD-MAG |     -      |   1.74(0.92)    |   99.99(0.15)   |   0.36(0.40)    |
|Fast-MUOD-SHA |     -      |   7.94(1.34)    |   7.79(4.86)    |   7.94(1.48)    |
|Fast-MUOD-AMP |     -      |   1.70(0.83)    |   1.66(2.43)    |   1.69(0.93)    |
|Semifast-MUOD |     -      |   9.58(1.54)    |  100.00(0.00)   |   8.66(1.53)    |
|OGMBD         |     -      |   4.77(1.25)    |  100.00(0.00)   |   4.65(1.35)    |
|MSPLOT        |     -      |   3.72(1.41)    |   99.97(0.33)   |   2.90(1.24)    |
|TVD           |     -      |   0.00(0.03)    |  100.00(0.00)   |   0.00(0.03)    |

---

# Simulation Models 3 - 4

- Plot of simulation models 3 and 4 &lt;sup&gt;*&lt;/sup&gt;: 

- Outliers in orange

&lt;img src="gfx/model3-4.png" width="100%" style="display: block; margin: auto;" /&gt;

.footnote[[*] Image credit: [Ojo et al. (2021)](https://link.springer.com/article/10.1007/s11634-021-00460-9)]
---
# Results Models 3 - 4

- Data were generated from Model 3 and Model 4

- Each data contains 300 curves with 10% outliers. Curves evaluated on 60 domain points

- 500 repetitions. % TPR and FPR are shown with standard deviations


|Method        | TPR-Model3 (SD) | FPR-Model3 (SD) | TPR-Model4 (SD) | FPR-Model4 (SD) |
|:-------------|:---------------:|:---------------:|:---------------:|:---------------:|
|Fast-MUOD     |   99.81(0.89)   |   6.10(1.37)    |  100.00(0.00)   |   3.15(1.13)    |
|Fast-MUOD-MAG |   4.13(3.70)    |   1.52(0.89)    |   41.25(9.71)   |   0.63(0.54)    |
|Fast-MUOD-SHA |   98.97(2.03)   |   4.36(1.12)    |  100.00(0.00)   |   2.24(0.95)    |
|Fast-MUOD-AMP |   6.41(4.62)    |   1.38(0.80)    |  54.56(11.76)   |   0.45(0.45)    |
|Semifast-MUOD |   99.49(1.49)   |   5.60(1.32)    |   99.94(0.44)   |   2.65(1.02)    |
|OGMBD         |  39.43(11.40)   |   3.45(1.16)    |   93.54(5.21)   |   1.22(0.72)    |
|MSPLOT        |  100.00(0.00)   |   2.95(1.34)    |   99.95(0.39)   |   1.36(0.84)    |
|TVD           |  100.00(0.00)   |   0.00(0.00)    |   2.77(3.77)    |   0.00(0.00)    |

---
# Simulation Models 5 - 6
- Plot of simulation models 5 and 6 &lt;sup&gt;*&lt;/sup&gt;: 

- Outliers in orange

&lt;img src="gfx/model5-6.png" width="100%" style="display: block; margin: auto;" /&gt;

.footnote[[*] Image credit: [Ojo et al. (2021)](https://link.springer.com/article/10.1007/s11634-021-00460-9)]

---
# Results Models 5 - 6

- Data were generated from Model 5 and Model 6

- Each data contains 300 curves with 10% outliers. Curves evaluated on 60 domain points

- 500 repetitions. % TPR and FPR are shown with standard deviations


|Method        | TPR-Model5 (SD) | FPR-Model5 (SD) | TPR-Model6 (SD) | FPR-Model6 (SD) |
|:-------------|:---------------:|:---------------:|:---------------:|:---------------:|
|Fast-MUOD     |   95.97(4.27)   |   5.67(1.19)    |   93.05(6.42)   |   6.31(1.35)    |
|Fast-MUOD-MAG |   15.94(6.70)   |   1.08(0.71)    |   0.83(1.70)    |   1.77(0.94)    |
|Fast-MUOD-SHA |   86.35(6.74)   |   4.39(1.12)    |   91.01(6.75)   |   4.35(1.10)    |
|Fast-MUOD-AMP |   22.99(7.93)   |   1.01(0.71)    |   3.54(3.78)    |   1.40(0.79)    |
|Semifast-MUOD |   94.05(5.00)   |   5.27(1.22)    |   92.46(6.31)   |   5.87(1.32)    |
|OGMBD         |   95.99(4.02)   |   1.97(0.88)    |   99.89(0.60)   |   1.88(0.89)    |
|MSPLOT        |   99.99(0.15)   |   2.81(1.21)    |  100.00(0.00)   |   2.91(1.26)    |
|TVD           |  100.00(0.00)   |   0.00(0.02)    |  84.25(12.13)   |   0.00(0.02)    |

---
# Simulation Models 7 - 8

- Plot of simulation models 7 and 8 &lt;sup&gt;*&lt;/sup&gt;: 

- Outliers in orange

&lt;img src="gfx/model7-8.png" width="100%" style="display: block; margin: auto;" /&gt;


.footnote[[*] Image credit: [Ojo et al. (2021)](https://link.springer.com/article/10.1007/s11634-021-00460-9)]
---
# Results Models 7 - 8

- Data were generated from Model 7 and Model 8

- Each data contains 300 curves with 10% outliers. Curves evaluated on 60 domain points

- 500 repetitions. % TPR and FPR are shown with standard deviations


|Method        | TPR-Model7 (SD) | FPR-Model7 (SD) | TPR-Model8 (SD) | FPR-Model8 (SD) |
|:-------------|:---------------:|:---------------:|:---------------:|:---------------:|
|Fast-MUOD     |  79.73(14.95)   |   6.55(1.91)    |   98.63(2.45)   |   6.65(1.40)    |
|Fast-MUOD-MAG |   1.65(2.36)    |   1.69(0.90)    |   30.65(8.10)   |   1.04(0.75)    |
|Fast-MUOD-SHA |   4.21(3.68)    |   4.94(1.72)    |   71.77(7.58)   |   5.31(1.29)    |
|Fast-MUOD-AMP |  79.10(15.42)   |   0.01(0.05)    |   10.74(5.69)   |   1.29(0.83)    |
|Semifast-MUOD |  67.31(17.06)   |   6.54(1.86)    |   98.11(2.69)   |   6.19(1.35)    |
|OGMBD         |  15.40(14.65)   |   0.00(0.00)    |   82.99(7.39)   |   2.87(1.16)    |
|MSPLOT        |  66.39(16.04)   |   0.02(0.08)    |   99.98(0.26)   |   2.85(1.31)    |
|TVD           |  40.88(12.82)   |   0.00(0.02)    |   99.42(1.51)   |   0.00(0.00)    |

---
# Computational Time

- We measure the maximum sample size each method can handle under 10s.

- Data generated from Model2 with 100 observed points (on each function) and 5% outliers. 

- Test carried out on a machine with Core i9 8950HK processor (6 cores, 12 threads, up to 4.8GHz) with 32GB RAM.


|Method          | Sample Size | Time (s) |
|:---------------|:-----------:|:--------:|
|Fast-MUOD       |   1060000   |  9.889   |
|Semifast-MUOD   |    10000    |  7.361   |
|Semifast-MUOD25 |    20000    |  9.250   |
|OGMBD           |    1000     |  8.055   |
|MSPLOT          |    50000    |  9.373   |
|TVD             |    2000     |  9.965   |



---
class: inverse, center, middle

# Application: Fast-MUOD

---
# Spanish Weather Data 

- Spanish weather data collected by the "Agencia de Estatal de Meteorologia"

- Contains daily average temperature, precipitation, between 1980-2009.

- Collected from 73 weather stations in Spain

- **Objective** Identify weather stations with different temperature/precipitation curves (outliers)

- Data were first smoothed, Fast-MUOD was then used on the data

- For the temperature curves: 
  - 7 weather stations on the Canary Islands are flagged simultaneously as
amplitude, shape and magnitude outliers
  - 2 pure shape outliers: 1 weather station on the Canary Islands, the other station on the souther tip of Spain
  - 1 pure magnitude outliers: a weather station in Puerto de Navacerrada, Madrid.


---
# Spanish Weather Data

&lt;img src="gfx/spanish_weather_with_fast.png" width="85%" style="display: block; margin: auto;" /&gt;


---

# World Population Data

- World population data from the United Nations. 
- Yearly total population of 105 countries/regions from July, 1950 to 2015. 
- Functional data is made up of 105 curves observed at 65 domain points. 
- **Objective** Identify countries with unusual population growth between 1950 to 2015. 
- Comparison with previous study [Dai et al. (2020)]() shows similar results.

- 33 **unique countries** detected as outliers: 
  - 3 magnitude outliers (Saudi Arabia, Sudan, Uganda)
  - 15 amplitude outliers (Saudi Arabia, Iraq, Sudan Uganda, Malaysia, Yemen,...)
  - 18 shape outliers (Bulgaria, Latvia, Georgia, Croatia, Estonia, Czech Republic...)
  
- Outlier groups are not mutually exclusive  

---

# World Population Data

&lt;img src="gfx/pop_data_fast.png" width="85%" style="display: block; margin: auto;" /&gt;

---
# Surveillance Video Data

- A surveillance video data named *WalkByShop1front* &lt;sup&gt;*&lt;/sup&gt; 

- Filmed by a camera across the hallway in a shopping centre in Lisbon. 

- Shows the front of a clothing store with people walking through the corridor in front of the shop. 

- **Objective** Identify points in video when people pass by the front of the store (outliers).

--

- Video is 94s @ 25FPS which gives a total of `\(2359\)` frames.

- Each of the frame is made up of `\(384 \times 288 = 110,592\)` pixels. 

- We convert the RGB values of each pixels to gray scale

- We consider each frame as a functional data observed on `\(110,592\)` points.

- The constructed functional data is `\(2359\)` curves observed on `\(110,592\)` domain points.

.footnote[[*] Video made availble by  [the CAVIAR project](http://homepages.inf.ed.ac.uk/rbf/CAVIARDATA1/)] 

---
# Surveillance Video: Frame 1

&lt;img src="gfx/video_data_analysis/frame1_video.png" width="70%" style="display: block; margin: auto;" /&gt;

---
# Frame 1: Grayscale

&lt;img src="gfx/video_data_analysis/frame1_video_grey.png" width="70%" style="display: block; margin: auto;" /&gt;

---
# Frame 1: Functional Data

&lt;img src="gfx/video_data_analysis/frame1_video_grey_function.png" width="100%" style="display: block; margin: auto;" /&gt;

---
# Video Data

&lt;img src="gfx/video_data_analysis/animation_walkbyshop1.gif" width="70%" style="display: block; margin: auto;" /&gt;

---
# Video Data

&lt;video width="896" height="504"&gt;
&lt;source src="gfx/video_data_analysis/animation_walkbyshop1_indices.mp4" type="video/mp4"&gt;
&lt;/video&gt;

---
# Video Data

&lt;img src="gfx/video_data_analysis/animation_walkbyshop2.gif" width="70%" style="display: block; margin: auto;" /&gt;

---
# Video Data

&lt;video width="896" height="504"&gt;
&lt;source src="gfx/video_data_analysis/animation_walkbyshop2_indices.mp4" type="video/mp4"&gt;
&lt;/video&gt;

---
# Video Data Results Summary

- 294 *unique frames* flagged as outliers :
 - 216 shape outliers
 - 206 amplitude outliers
 - 194 magnitude outliers
 
- Outlier classes are not mutually exclusive
- 125 outliers are simultaneously amplitude, magnitude and shape outliers.
- All outliers flagged correspond to frames with people passing by font of store (*no false positive*)

- Some pocket of frames with people were not flagged as outliers (frames with little contrast between the person and the store background).

- Comparison with competing methods:
  - **TVD** flagged all frames as outliers (*after running for 9hrs., compared to 42s for Fast-MUOD*)
  - **MSPLOT** didn't produce any result due to some *computational error*

---

# Frame 2110

&lt;img src="gfx/video_data_analysis/frame2110_video_grey.png" width="70%" style="display: block; margin: auto;" /&gt;

---
#Conclusion and Summary

- High level description of Functional Data Analysis (FDA)

- Description of outliers in functional setting

- We proposed two methods:
  - **Fast-MUOD**
  - **Semifast-MUOD**
  
- Both methods are **unbelievably simple**, yet effective.

- Type of outlier is provided by the methods automatically.

- **Fast-MUOD** is scalable. 
  
- We show good performance of the methods, especially **Fast-MUOD** using various simulated and real data sets.

---
class: center, middle

**Thanks!** 

Find me at...

[&lt;svg viewBox="0 0 496 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"&gt;&lt;/path&gt;&lt;/svg&gt; @otsegun](http://github.com/otsegun)  
[&lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M440 6.5L24 246.4c-34.4 19.9-31.1 70.8 5.7 85.9L144 379.6V464c0 46.4 59.2 65.5 86.6 28.6l43.8-59.1 111.9 46.2c5.9 2.4 12.1 3.6 18.3 3.6 8.2 0 16.3-2.1 23.6-6.2 12.8-7.2 21.6-20 23.9-34.5l59.4-387.2c6.1-40.1-36.9-68.8-71.5-48.9zM192 464v-64.6l36.6 15.1L192 464zm212.6-28.7l-153.8-63.5L391 169.5c10.7-15.5-9.5-33.5-23.7-21.2L155.8 332.6 48 288 464 48l-59.4 387.3z"&gt;&lt;/path&gt;&lt;/svg&gt; oluwasegun.ojo@imdea.org](mailto:oluwasegun.ojo@imdea.org)





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
